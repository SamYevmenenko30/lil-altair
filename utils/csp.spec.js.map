{"version":3,"file":"csp.spec.js","sources":["utils/csp.spec.ts"],"sourceRoot":"/","sourcesContent":["import { cspAsString } from './csp';\n\ndescribe('cspAsString', () => {\n  it('should return a valid CSP string', () => {\n    const csp = {\n      'default-src': [\"'self'\", \"'unsafe-inline'\"],\n      'script-src': [\n        \"'self'\",\n        'sha256-abc123',\n        'https://example.com',\n        \"'nonce-xyz789'\",\n        'unsafe-eval',\n      ],\n      'style-src': [\"'self'\", \"'nonce-xyz789'\"],\n    };\n\n    const result = cspAsString(csp);\n    expect(result).toBe(\n      \"default-src 'self' 'unsafe-inline'; script-src 'self' 'sha256-abc123' https://example.com 'nonce-xyz789' 'unsafe-eval'; style-src 'self' 'nonce-xyz789'\"\n    );\n  });\n});\n"],"names":[],"mappings":";;;;AAAA,+BAAoC;AAEpC,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;IAC3B,EAAE,CAAC,kCAAkC,EAAE,GAAG,EAAE;QAC1C,MAAM,GAAG,GAAG;YACV,aAAa,EAAE,CAAC,QAAQ,EAAE,iBAAiB,CAAC;YAC5C,YAAY,EAAE;gBACZ,QAAQ;gBACR,eAAe;gBACf,qBAAqB;gBACrB,gBAAgB;gBAChB,aAAa;aACd;YACD,WAAW,EAAE,CAAC,QAAQ,EAAE,gBAAgB,CAAC;SAC1C,CAAC;QAEF,MAAM,MAAM,GAAG,IAAA,iBAAW,EAAC,GAAG,CAAC,CAAC;QAChC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CACjB,yJAAyJ,CAC1J,CAAC;IACJ,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","debug_id":"7ef2fd31-f9b8-5eaf-a434-c85ed7cd0651"}