{"version":3,"file":"index.js","sources":["utils/index.ts"],"sourceRoot":"/","sourcesContent":["/* eslint-disable no-sync */\nimport { readdir } from 'fs';\nimport fs from 'fs';\nimport { join } from 'path';\nimport { App, ipcMain } from 'electron';\nimport { ALTAIR_CUSTOM_PROTOCOL } from '@altairgraphql/electron-interop';\n\nexport const getDirectoriesInDirectory = (path: string) => {\n  return new Promise<string[]>((resolve, reject) => {\n    readdir(path, { withFileTypes: true }, (err, dirents) =>\n      err\n        ? reject(err)\n        : resolve(\n            dirents\n              .filter((dirent) => dirent.isDirectory())\n              .map((dirent) => dirent.name)\n          )\n    );\n  });\n};\n\nexport const deleteFolderRecursive = (path: string) => {\n  if (fs.existsSync(path)) {\n    fs.readdirSync(path).forEach((file) => {\n      const curPath = join(path, file);\n      if (fs.lstatSync(curPath).isDirectory()) {\n        // recurse\n        deleteFolderRecursive(curPath);\n      } else {\n        // delete file\n        fs.unlinkSync(curPath);\n      }\n    });\n    fs.rmdirSync(path);\n  }\n};\n\nexport const getStaticDirectory = () => {\n  return join(__dirname, '../../static');\n};\n\nconst encodeError = (e: Error) => {\n  return { name: e.name, message: e.message, extra: { ...e } };\n};\n\nexport const handleWithCustomErrors = (\n  channel: string,\n  handler: (event: Electron.IpcMainInvokeEvent, ...args: unknown[]) => unknown\n) => {\n  ipcMain.handle(channel, async (...args) => {\n    try {\n      return { result: await Promise.resolve(handler(...args)) };\n    } catch (e) {\n      if (e instanceof Error) {\n        return { error: encodeError(e) };\n      }\n      return { error: { name: 'unknown error', message: 'unknown error' } };\n    }\n  });\n};\n\n// We don't know the exact position of the URL is in argv. Chromium might inject its own arguments\n// into argv. See https://www.electronjs.org/docs/latest/api/app#event-second-instance.\nexport function findCustomProtocolUrlInArgv(argv: string[]) {\n  return argv.find((arg) => arg.startsWith(`${ALTAIR_CUSTOM_PROTOCOL}://`));\n}\n\nexport function restartApp(app: App) {\n  app.relaunch();\n  app.exit();\n}\n"],"names":[],"mappings":"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","debug_id":"a96312ab-2cd0-5c43-ba63-f3562c326516"}