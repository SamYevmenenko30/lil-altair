{"version":3,"file":"interop-state-manager.js","sources":["interop-state-manager.ts"],"sourceRoot":"/","sourcesContent":["import { InteropAppState } from '@altairgraphql/electron-interop';\nimport { BehaviorSubject, distinctUntilChanged, map, Observable } from 'rxjs';\n\nexport class InteropStateManager {\n  /** BehaviorSubject that holds the current state */\n  private readonly stateSubject = new BehaviorSubject<InteropAppState>({\n    windows: {},\n  });\n\n  constructor(initialState?: InteropAppState) {\n    if (initialState) {\n      this.stateSubject.next(initialState);\n    }\n  }\n\n  getState(): InteropAppState {\n    return this.stateSubject.getValue();\n  }\n\n  setState(state: InteropAppState) {\n    this.stateSubject.next(state);\n  }\n\n  getWindowState(windowId: string): InteropAppState['windows'][string] | undefined {\n    return this.stateSubject.getValue().windows[windowId];\n  }\n\n  setWindowState(windowId: string, windowState: InteropAppState['windows'][string]) {\n    const currentState = this.stateSubject.getValue();\n    this.stateSubject.next({\n      ...currentState,\n      windows: {\n        ...currentState.windows,\n        [windowId]: windowState,\n      },\n    });\n  }\n\n  asObservable(): Observable<InteropAppState> {\n    return this.stateSubject.asObservable();\n  }\n\n  asActiveWindowStateObservable(): Observable<InteropAppState['windows'][string]> {\n    return this.asObservable().pipe(\n      map((state) =>\n        state.activeWindowId\n          ? state.windows[state.activeWindowId] ?? this.defaultWindowState()\n          : this.defaultWindowState()\n      ),\n      distinctUntilChanged()\n    );\n  }\n\n  asWindowStateObservable(\n    windowId: string\n  ): Observable<InteropAppState['windows'][string]> {\n    return this.asObservable().pipe(\n      map((state) => state.windows[windowId] ?? this.defaultWindowState()),\n      distinctUntilChanged()\n    );\n  }\n\n  private defaultWindowState(): InteropAppState['windows'][string] {\n    return {\n      windowId: '',\n      headers: [],\n      showDocs: false,\n    };\n  }\n}\n"],"names":[],"mappings":";;;;;AACA,+BAA8E;AAE9E,MAAa,mBAAmB;IAM9B,YAAY,YAA8B;QAL1C,mDAAmD;QAClC,iBAAY,GAAG,IAAI,sBAAe,CAAkB;YACnE,OAAO,EAAE,EAAE;SACZ,CAAC,CAAC;QAGD,IAAI,YAAY,EAAE,CAAC;YACjB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACvC,CAAC;IACH,CAAC;IAED,QAAQ;QACN,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;IACtC,CAAC;IAED,QAAQ,CAAC,KAAsB;QAC7B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAChC,CAAC;IAED,cAAc,CAAC,QAAgB;QAC7B,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IACxD,CAAC;IAED,cAAc,CAAC,QAAgB,EAAE,WAA+C;QAC9E,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;QAClD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;YACrB,GAAG,YAAY;YACf,OAAO,EAAE;gBACP,GAAG,YAAY,CAAC,OAAO;gBACvB,CAAC,QAAQ,CAAC,EAAE,WAAW;aACxB;SACF,CAAC,CAAC;IACL,CAAC;IAED,YAAY;QACV,OAAO,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,CAAC;IAC1C,CAAC;IAED,6BAA6B;QAC3B,OAAO,IAAI,CAAC,YAAY,EAAE,CAAC,IAAI,CAC7B,IAAA,UAAG,EAAC,CAAC,KAAK,EAAE,EAAE,CACZ,KAAK,CAAC,cAAc;YAClB,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,IAAI,CAAC,kBAAkB,EAAE;YAClE,CAAC,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAC9B,EACD,IAAA,2BAAoB,GAAE,CACvB,CAAC;IACJ,CAAC;IAED,uBAAuB,CACrB,QAAgB;QAEhB,OAAO,IAAI,CAAC,YAAY,EAAE,CAAC,IAAI,CAC7B,IAAA,UAAG,EAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,kBAAkB,EAAE,CAAC,EACpE,IAAA,2BAAoB,GAAE,CACvB,CAAC;IACJ,CAAC;IAEO,kBAAkB;QACxB,OAAO;YACL,QAAQ,EAAE,EAAE;YACZ,OAAO,EAAE,EAAE;YACX,QAAQ,EAAE,KAAK;SAChB,CAAC;IACJ,CAAC;CACF;AAlED,kDAkEC","debug_id":"128adbcd-d575-5ac8-9cbc-ff5956f95a4c"}